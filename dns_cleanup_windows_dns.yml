---
- hosts: all
  gather_facts: no
  tasks:
    - name: Remove Old hostname in DNS server
      win_dns_record:
        name: "{{ old_vm }}"
        type: "{{item}}"
        zone: "iisl.lab.zone"
        state: absent
      with_items:
        - A
        - PTR

    - name: Add New hostname in DNS server - Creating A Record
      win_dns_record:
        name: "{{ new_vm }}"
        type: "A"
        zone: "iisl.lab.zone"
        value: "{{new_ip}}"

    - name: Add New hostname in DNS server - Creating PTR Record
      win_dns_record:
        name: "{{ new_ip }}"
        type: "PTR"
        zone: "2.168.192.in-addr.arpa"
        value: "{{new_vm}}"
